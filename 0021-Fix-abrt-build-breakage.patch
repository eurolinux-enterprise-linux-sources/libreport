From 9b3d80259a3c00dfe529789badfc368caa565fad Mon Sep 17 00:00:00 2001
From: Denys Vlasenko <vda.linux@googlemail.com>
Date: Fri, 11 May 2012 14:44:46 +0200
Subject: [PATCH 21/53] Fix abrt build breakage

Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
---
 src/include/internal_libreport.h | 8 ++++++--
 src/plugins/ureport.c            | 1 +
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/src/include/internal_libreport.h b/src/include/internal_libreport.h
index 646246f..f4668f2 100644
--- a/src/include/internal_libreport.h
+++ b/src/include/internal_libreport.h
@@ -89,7 +89,6 @@ int vdprintf(int d, const char *format, va_list ap);
 #include "problem_data.h"
 #include "report.h"
 #include "run_event.h"
-#include "abrt_curl.h"
 
 #ifdef __cplusplus
 extern "C" {
@@ -789,8 +788,13 @@ unsigned parse_opts(int argc, char **argv, const struct options *opt,
 #define show_usage_and_die libreport_show_usage_and_die
 void show_usage_and_die(const char *usage, const struct options *opt) NORETURN;
 
+/* Can't include "abrt_curl.h", it's not a public API.
+ * Resorting to just forward-declaring the struct we need.
+ */
+struct abrt_post_state;
+
 #define post_ureport libreport_post_ureport
-abrt_post_state_t *post_ureport(problem_data_t *pd, const char *ureport_url);
+struct abrt_post_state *post_ureport(problem_data_t *pd, const char *ureport_url);
 
 #ifdef __cplusplus
 }
diff --git a/src/plugins/ureport.c b/src/plugins/ureport.c
index f883e5c..f0a6428 100644
--- a/src/plugins/ureport.c
+++ b/src/plugins/ureport.c
@@ -18,6 +18,7 @@
 */
 
 #include "internal_libreport.h"
+#include "abrt_curl.h"
 
 int main(int argc, char **argv)
 {
-- 
1.7.11.2

