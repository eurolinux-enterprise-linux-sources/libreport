From 67ef6062fe206432616db5a8bb9a0e32117b1147 Mon Sep 17 00:00:00 2001
From: Denys Vlasenko <dvlasenk@redhat.com>
Date: Tue, 16 Apr 2013 17:50:23 +0200
Subject: [RHEL6 LIBREPORT PATCH 91/94] reporter-upload: create tarball with
 the name based on directory's name

Signed-off-by: Denys Vlasenko <dvlasenk@redhat.com>
Signed-off-by: Jakub Filak <jfilak@redhat.com>
---
 src/plugins/reporter-upload.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/plugins/reporter-upload.c b/src/plugins/reporter-upload.c
index 7c8bf15..d09944c 100644
--- a/src/plugins/reporter-upload.c
+++ b/src/plugins/reporter-upload.c
@@ -49,7 +49,9 @@ static int create_and_upload_archive(
     /* Create a child gzip which will compress the data */
     /* SELinux guys are not happy with /tmp, using /var/run/abrt */
     /* Reverted back to /tmp for ABRT2 */
-    tempfile = xasprintf("/tmp/abrt-upload-%s-%lu.tar.gz", iso_date_string(NULL), (long)getpid());
+    tempfile = concat_path_basename("/tmp", dump_dir_name);
+    tempfile = append_to_malloced_string(tempfile, ".tar.gz");
+
     int pipe_from_parent_to_child[2];
     xpipe(pipe_from_parent_to_child);
     child = vfork();
-- 
1.8.2.1

