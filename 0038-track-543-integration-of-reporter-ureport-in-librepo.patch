From 89d26b22c063eab5a1a5b472e8fc3652dc3a5a8e Mon Sep 17 00:00:00 2001
From: Jakub Filak <jfilak@redhat.com>
Date: Wed, 30 May 2012 17:21:03 +0200
Subject: [PATCH 38/53] track#543 : integration of reporter-ureport in
 libreport events

Signed-off-by: Jakub Filak <jfilak@redhat.com>
---
 libreport.spec.in                 |  2 ++
 po/POTFILES.in                    |  1 +
 src/plugins/Makefile.am           |  9 ++++++---
 src/plugins/report_uReport.xml.in | 17 +++++++++++++++++
 src/plugins/ureport_event.conf    | 11 +++++++++++
 5 files changed, 37 insertions(+), 3 deletions(-)
 create mode 100644 src/plugins/report_uReport.xml.in
 create mode 100644 src/plugins/ureport_event.conf

diff --git a/po/POTFILES.in b/po/POTFILES.in
index 007efda..9fac721 100644
--- a/po/POTFILES.in
+++ b/po/POTFILES.in
@@ -23,6 +23,7 @@ src/plugins/report_Logger.xml.in
 src/plugins/report_Mailx.xml.in
 src/plugins/report_RHTSupport.xml.in
 src/plugins/report_Uploader.xml.in
+src/plugins/report_uReport.xml.in
 src/plugins/reporter-bugzilla.c
 src/plugins/reporter-kerneloops.c
 src/plugins/reporter-mailx.c
diff --git a/src/plugins/Makefile.am b/src/plugins/Makefile.am
index 476a59d..604fcf5 100644
--- a/src/plugins/Makefile.am
+++ b/src/plugins/Makefile.am
@@ -30,7 +30,8 @@ dist_events_DATA = \
     report_Mailx.xml \
     report_RHTSupport.xml \
     report_Kerneloops.xml \
-    report_Uploader.xml
+    report_Uploader.xml \
+    report_uReport.xml
 
 @INTLTOOL_XML_RULE@
 
@@ -41,7 +42,8 @@ dist_eventsconf_DATA = \
     print_event.conf \
     bugzilla_event.conf \
     rhtsupport_event.conf \
-    uploader_event.conf
+    uploader_event.conf \
+    ureport_event.conf
 
 EXTRA_DIST = \
     report_Bugzilla.xml.in \
@@ -51,7 +53,8 @@ EXTRA_DIST = \
     report_Mailx.xml.in \
     report_RHTSupport.xml.in \
     report_Kerneloops.xml.in \
-    report_Uploader.xml.in
+    report_Uploader.xml.in \
+    report_uReport.xml.in
 
 $(DESTDIR)/$(DEBUG_INFO_DIR):
 	$(mkdir_p) '$@'
diff --git a/src/plugins/report_uReport.xml.in b/src/plugins/report_uReport.xml.in
new file mode 100644
index 0000000..77b5880
--- /dev/null
+++ b/src/plugins/report_uReport.xml.in
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<event>
+    <_name>uReport</_name>
+    <_description>Sends ureports to FAF server</_description>
+
+    <requires-items>analyzer,reason,executable,pkg_epoch,pkg_name,pkg_version,pkg_release,pkg_arch,os_release,architecture,core_backtrace</requires-items>
+    <gui-review-elements>no</gui-review-elements>
+
+    <options>
+        <option type="text" name="uReport_URL">
+            <_label>uReport Server URL</_label>
+            <allow-empty>no</allow-empty>
+            <_description>Address of uReport webservice</_description>
+            <default-value>https://retrace.fedoraproject.org/faf/reports/new/</default-value>
+        </option>
+    </options>
+</event>
diff --git a/src/plugins/ureport_event.conf b/src/plugins/ureport_event.conf
new file mode 100644
index 0000000..2d465b8
--- /dev/null
+++ b/src/plugins/ureport_event.conf
@@ -0,0 +1,11 @@
+EVENT=report_uReport analyzer=CCpp reporter-ureport
+
+EVENT=report_uReport analyzer=Python reporter-ureport
+
+EVENT=report_uReport analyzer=Kerneloops reporter-ureport
+
+EVENT=report-gui analyzer=CCpp
+        report-gtk -e report_uReport -e analyze_LocalGDB -e report_Bugzilla -- "$DUMP_DIR"
+
+EVENT=report-gui analyzer!=CCpp
+        report-gtk -e report_uReport -e report_Bugzilla -- "$DUMP_DIR"
-- 
1.7.11.2

