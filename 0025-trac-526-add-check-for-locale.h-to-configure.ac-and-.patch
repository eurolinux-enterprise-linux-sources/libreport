From bf07d37ef2f1e2ab4891621048744b41bbd8ca35 Mon Sep 17 00:00:00 2001
From: Jakub Filak <jfilak@redhat.com>
Date: Mon, 14 May 2012 15:32:30 +0200
Subject: [PATCH 25/53] trac#526 : add check for locale.h to configure.ac and
 include the header if is available

Signed-off-by: Jakub Filak <jfilak@redhat.com>
---
 configure.ac                     | 2 ++
 src/include/internal_libreport.h | 4 ++++
 2 files changed, 6 insertions(+)

diff --git a/configure.ac b/configure.ac
index 2d5dd25..459db9c 100644
--- a/configure.ac
+++ b/configure.ac
@@ -94,6 +94,8 @@ PKG_PROG_PKG_CONFIG
 AC_CHECK_HEADER([libtar.h], [],
    [AC_MSG_ERROR([libtar.h is needed to build libreport])])
 
+AC_CHECK_HEADERS([locale.h])
+
 CONF_DIR='${sysconfdir}/${PACKAGE_NAME}'
 VAR_RUN='${localstatedir}/run'
 PLUGINS_CONF_DIR='${sysconfdir}/${PACKAGE_NAME}/plugins'
diff --git a/src/include/internal_libreport.h b/src/include/internal_libreport.h
index f4668f2..c76d882 100644
--- a/src/include/internal_libreport.h
+++ b/src/include/internal_libreport.h
@@ -67,6 +67,10 @@
 # define _(S) (S)
 #endif
 
+#if HAVE_LOCALE_H
+# include <locale.h>
+#endif /* HAVE_LOCALE_H */
+
 /* Some libc's forget to declare these, do it ourself */
 extern char **environ;
 #if defined(__GLIBC__) && __GLIBC__ < 2
-- 
1.7.11.2

